<!DOCTYPE html>
<html>
<head>
    <title>Mapa de Centros de Investigación en Colombia</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        #map { height: 500px; width: 100%; }
        .chart-container { width: 300px; height: 200px; }
        #categorySelector, #citySelector {
            font-size: 20px; /* Aumenta el tamaño de la fuente */
            padding: 5px; /* Añade un poco de padding */
        }
        .filter-container {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="filter-container">
        <label for="categorySelector">Filtrar por Categoría:</label>
        <select id="categorySelector">
            <option value="All">Todas</option>
            <option value="Ciencias Agrícolas">Ciencias Agrícolas</option>
            <option value="Ciencias Médicas y de Salud">Ciencias Médicas y de Salud</option>
            <option value="Ciencias Naturales">Ciencias Naturales</option>
            <option value="Ciencias Sociales">Ciencias Sociales</option>
            <option value="Humanidades">Humanidades</option>
            <option value="Industrial">Industrial</option>
            <option value="Ingeniería y Tecnología">Ingeniería y Tecnología</option>
        </select>
    </div>
    <div class="filter-container">
        <label for="citySelector">Filtrar por Ciudad o Municipio:</label>
        <select id="citySelector">
            <option value="All">Todas</option>
            <option value="Bogotá">Bogotá</option>
            <option value="Medellín">Medellín</option>
            <option value="Cali">Cali</option>
            <option value="Barranquilla">Barranquilla</option>
            <option value="Cartagena">Cartagena</option>
            <!-- Agrega más opciones según tus necesidades -->
        </select>
    </div>
    <div id="map"></div>
    <script>
        const centros = [
{
    "nombre": "CINTEL",
    "lat": 4.690793,
    "lng": -74.031831,
    "ciudad": "Bogotá",
    "categoria": "Ingeniería y Tecnología",
    "publicaciones": {
        "2013": 3,
        "2019": 3,
        "2020": 3,
        "1999": 2,
        "2001": 1,
        "2002": 1,
        "2004": 1,
        "2011": 1,
        "2012": 1,
        "2016": 1,
        "2021": 1,
        "2023": 1
    }
},
{
    "nombre": "FIDIC",
    "lat": 4.63713,
    "lng": -74.08523,
    "ciudad": "Bogotá",
    "categoria": "Ciencias Agrícolas",
    "publicaciones": {
        "2017": 36,
        "2011": 34,
        "2018": 32,
        "2020": 31,
        "2004": 30,
        "2005": 30,
        "2010": 30,
        "2021": 28,
        "2008": 27,
        "2003": 26,
        "2019": 26,
        "2009": 23,
        "2002": 22,
        "2022": 21,
        "2007": 20,
        "2013": 19,
        "2006": 18,
        "2015": 18,
        "2016": 18,
        "2023": 18,
        "2014": 16,
        "2012": 10,
        "2001": 7,
        "1999": 4,
        "2024": 4,
        "1993": 3,
        "1997": 2,
        "2000": 2,
        "1987": 1,
        "1991": 1,
        "1995": 1,
        "1998": 1
    }
},
{
    "nombre": "CENICAFE",
    "lat": 4.99778,
    "lng": -75.60769,
    "ciudad": "Chinchina",
    "categoria": "Ciencias Agrícolas",
    "publicaciones": {
        "2015": 25,
        "2022": 23,
        "2008": 20,
        "2011": 18,
        "2005": 16,
        "2012": 16,
        "2021": 16,
        "2004": 15,
        "2014": 15,
        "2003": 14,
        "2016": 14,
        "2017": 14,
        "2018": 14,
        "2010": 13,
        "2023": 13,
        "2006": 12,
        "2009": 12,
        "2019": 12,
        "2002": 11,
        "2013": 11,
        "2020": 10,
        "2001": 9,
        "2007": 9,
        "1994": 8,
        "2000": 8,
        "1997": 7,
        "1999": 7,
        "1995": 6,
        "1996": 5,
        "1998": 5,
        "1993": 4,
        "1985": 2,
        "1990": 2,
        "1991": 2,
        "2024": 2,
        "1828": 1,
        "1969": 1,
        "1974": 1,
        "1976": 1,
        "1978": 1,
        "1979": 1,
        "1981": 1,
        "1982": 1,
        "1987": 1,
        "1989": 1,
        "1992": 1
    }
},

{
    "nombre": "INS",
    "lat": 4.64828,
    "lng": -74.11761,
    "ciudad": "Bogota",
    "categoria": "Ciencias Médicas y de la Salud",
    "publicaciones": {
        "2021": 126,
        "2020": 115,
        "2022": 106,
        "2017": 100,
        "2023": 97,
        "2015": 93,
        "2012": 91,
        "2011": 90,
        "2019": 88,
        "2016": 72,
        "2014": 68,
        "2018": 64,
        "2008": 53,
        "2009": 53,
        "2010": 46,
        "2013": 45,
        "2007": 42,
        "2005": 41,
        "2001": 40,
        "2002": 34,
        "2006": 31,
        "2003": 30,
        "2004": 28,
        "1999": 22,
        "2000": 20,
        "1998": 18,
        "1996": 16,
        "1997": 15,
        "2024": 13,
        "1994": 12,
        "1990": 9,
        "1995": 8,
        "1986": 6,
        "1989": 6,
        "1983": 4,
        "1984": 4,
        "1985": 4,
        "1987": 4,
        "1988": 3,
        "1991": 3,
        "1982": 2,
        "1992": 2,
        "1993": 2,
        "1946": 1,
        "1970": 1,
        "1973": 1,
        "1976": 1,
        "1977": 1,
        "1980": 1,
        "1981": 1
    }
},
{
    "nombre": "CIAT",
    "lat": 3.4132,
    "lng": -76.3511,
    "ciudad": "Palmira",
    "categoria": "Ciencias Agrícolas",
    "publicaciones": {
        "2021": 360,
        "2022": 353,
        "2020": 331,
        "2023": 317,
        "2019": 263,
        "2018": 246,
        "2017": 207,
        "2016": 201,
        "2011": 188,
        "2015": 186,
        "2012": 168,
        "2010": 155,
        "2014": 152,
        "2007": 148,
        "2013": 146,
        "2009": 132,
        "2006": 124,
        "2008": 106,
        "2004": 92,
        "2005": 92,
        "2003": 90,
        "2002": 83,
        "2024": 77,
        "2001": 76,
        "1995": 75,
        "1993": 68,
        "1997": 68,
        "2000": 57,
        "1996": 56,
        "1998": 51,
        "1988": 48,
        "1989": 48,
        "1999": 48,
        "1984": 44,
        "1985": 42,
        "1987": 41,
        "1994": 41,
        "1978": 40,
        "1990": 40,
        "1991": 40,
        "1992": 39,
        "1982": 36,
        "1983": 35,
        "1986": 34,
        "1979": 29,
        "1980": 28,
        "1977": 27,
        "1981": 26,
        "1976": 17,
        "1974": 11,
        "1975": 9,
        "1973": 6,
        "1971": 5,
        "1970": 4,
        "1972": 4,
        "1962": 2,
        "1904": 1,
        "1933": 1,
        "1945": 1,
        "1956": 1
    }
},
{
    "nombre": "CINDE",
    "lat": 5.0519,
    "lng": -75.5136,
    "ciudad": "Manizales",
    "categoria": "Ciencias Sociales",
    "publicaciones": {
        "2022": 12,
        "2018": 11,
        "2011": 9,
        "2019": 9,
        "2017": 8,
        "2016": 7,
        "2020": 7,
        "2015": 6,
        "2014": 5,
        "2021": 5,
        "2013": 4,
        "2023": 4,
        "2007": 3,
        "1969": 1,
        "1982": 1,
        "1984": 1,
        "2009": 1,
        "2010": 1,
        "2012": 1
    }
},
{
    "nombre": "CIDEIM",
    "lat": 3.4095,
    "lng": -76.5400,
    "ciudad": "Cali",
    "categoria": "Ciencias medicas y de la salud",
    "publicaciones": {
        "2017": 37,
        "2012": 31,
        "2021": 29,
        "2011": 28,
        "2022": 27,
        "2020": 25,
        "2013": 24,
        "2018": 24,
        "2019": 24,
        "2006": 22,
        "2014": 20,
        "2023": 20,
        "2016": 19,
        "1998": 17,
        "2010": 16,
        "2015": 16,
        "2007": 15,
        "2002": 13,
        "2004": 12,
        "1995": 11,
        "2003": 11,
        "2008": 11,
        "1996": 10,
        "2005": 9,
        "2009": 9,
        "1999": 7,
        "2001": 7,
        "1992": 6,
        "1997": 6,
        "2024": 6,
        "1990": 5,
        "1993": 5,
        "1994": 5,
        "2000": 5,
        "1987": 4,
        "1985": 3,
        "1991": 3,
        "1984": 2,
        "1988": 2,
        "1989": 2,
        "1977": 1
    }
},
{
    "nombre": "FCV",
    "lat": 7.1192,
    "lng": -73.1185,
    "ciudad": "Bucaramanga",
    "categoria": "Ciencias medicas y de la salud",
    "publicaciones": {
        "2022": 90,
        "2021": 74,
        "2023": 69,
        "2020": 66,
        "2018": 65,
        "2016": 60,
        "2017": 58,
        "2019": 45,
        "2014": 41,
        "2013": 38,
        "2015": 37,
        "2012": 36,
        "2006": 30,
        "2007": 28,
        "2005": 24,
        "2024": 20,
        "2011": 19,
        "2008": 15,
        "2010": 14,
        "2009": 12,
        "2001": 10,
        "2004": 6,
        "2003": 4,
        "1997": 3,
        "1999": 2,
        "2002": 2,
        "1969": 1,
        "1981": 1,
        "1993": 1,
        "1994": 1,
        "1998": 1,
        "2000": 1
    }
},
{
    "nombre": "CENIPALMA",
    "lat": 4.6946,
    "lng": -74.0707,
    "ciudad": "Bogota DC",
    "categoria": "Ciencias Agricolas",
    "publicaciones": {
        "2023": 31,
        "2016": 22,
        "2022": 19,
        "2021": 17,
        "2013": 15,
        "2014": 15,
        "2012": 14,
        "2020": 14,
        "2015": 13,
        "2011": 10,
        "2019": 10,
        "2024": 9,
        "2017": 8,
        "2010": 7,
        "2018": 5,
        "1999": 2,
        "2000": 2,
        "2002": 2,
        "2005": 2,
        "2006": 2,
        "2007": 2,
        "2009": 2,
        "1993": 1,
        "1996": 1,
        "1997": 1,
        "1998": 1,
        "2003": 1,
        "2004": 1,
        "2008": 1
    }
},
{
    "nombre": "FASR",
    "lat": 4.7086,
    "lng": -74.0583,
    "ciudad": "Bogota DC",
    "categoria": "Ciencias medicas y de la salud",
    "publicaciones": {
        "2011": 4,
        "2012": 4,
        "2013": 4,
        "2014": 4,
        "2007": 2,
        "2015": 2,
        "2016": 2,
        "2019": 2,
        "2022": 2,
        "2009": 1,
        "2010": 1,
        "2018": 1,
        "2020": 1,
        "2021": 1,
        "2023": 1
    }
},
{
    "nombre": "CINEP",
    "lat": 4.6111,
    "lng": -74.0697,
    "ciudad": "Bogota DC",
    "categoria": "Ciencias Sociales",
    "publicaciones": {
        "2022": 198,
        "2020": 94,
        "2018": 92,
        "2021": 90,
        "2017": 83,
        "2019": 79,
        "2016": 70,
        "2014": 64,
        "2015": 61,
        "2023": 56,
        "2013": 40,
        "2011": 29,
        "2009": 28,
        "2012": 22,
        "2010": 21,
        "2004": 16,
        "2006": 15,
        "2007": 13,
        "2005": 12,
        "2002": 11,
        "2000": 10,
        "2003": 10,
        "2008": 10,
        "1997": 8,
        "1998": 8,
        "1999": 8,
        "1987": 6,
        "1991": 6,
        "1993": 6,
        "1986": 5,
        "1995": 5,
        "2001": 5,
        "1982": 4,
        "1990": 4,
        "1992": 4,
        "1985": 3,
        "1988": 3,
        "2024": 3,
        "1844": 2,
        "1975": 2,
        "1979": 2,
        "1981": 2,
        "1989": 2,
        "1493": 1,
        "1713": 1,
        "1970": 1,
        "1976": 1,
        "1980": 1,
        "1983": 1,
        "1984": 1,
        "1994": 1,
        "1996": 1
    }
},
{
    "nombre": "IEPRI",
    "lat": 4.6389,
    "lng": -74.0853,
    "ciudad": "Bogota DC",
    "categoria": "Ciencias Sociales",
    "publicaciones": {
        "2019": 36,
        "2022": 26,
        "2016": 22,
        "2017": 20,
        "2014": 19,
        "2020": 18,
        "2015": 16,
        "2018": 16,
        "2013": 14,
        "2011": 13,
        "2008": 12,
        "2021": 12,
        "2005": 11,
        "2010": 11,
        "2003": 9,
        "2007": 9,
        "2006": 8,
        "1999": 7,
        "2004": 7,
        "2009": 7,
        "2012": 6,
        "2023": 6,
        "2000": 5,
        "2001": 5,
        "2002": 4,
        "1998": 3,
        "1858": 2,
        "1994": 2,
        "1995": 2,
        "1654": 1,
        "1962": 1,
        "1970": 1,
        "1983": 1,
        "1986": 1,
        "1989": 1,
        "1997": 1
    }
},
{
    "nombre": "CINARA",
    "lat": 3.4326,
    "lng": -76.5320,
    "ciudad": "Cali",
    "categoria": "Ingenieria y Tecnologia",
    "publicaciones": {
        "2011": 5,
        "2021": 5,
        "2022": 5,
        "2009": 3,
        "2017": 3,
        "1975": 2,
        "2018": 2,
        "1969": 1,
        "1976": 1,
        "1996": 1,
        "1997": 1,
        "2006": 1,
        "2008": 1,
        "2015": 1,
        "2016": 1,
        "2020": 1
    }
},
{
    "nombre": "INMLCF",
    "lat": 4.6004,
    "lng": -74.0837,
    "ciudad": "Bogota",
    "categoria": "Ciencias medicas y de la salud",
    "publicaciones": {
        "2022": 204,
        "2019": 179,
        "2021": 149,
        "2020": 148,
        "2018": 108,
        "2015": 107,
        "2016": 104,
        "2023": 103,
        "2017": 88,
        "2014": 67,
        "2013": 41,
        "2012": 38,
        "2011": 35,
        "2010": 31,
        "2009": 23,
        "2005": 21,
        "2008": 21,
        "2007": 16,
        "2004": 10,
        "2002": 9,
        "1997": 6,
        "2006": 6,
        "2024": 6,
        "2003": 5,
        "2000": 4,
        "1993": 3,
        "1998": 3,
        "1999": 3,
        "2001": 3,
        "1957": 2,
        "1977": 2,
        "1950": 1,
        "1959": 1,
        "1963": 1,
        "1964": 1,
        "1969": 1,
        "1970": 1,
        "1978": 1,
        "1988": 1,
        "1990": 1,
        "1995": 1,
        "1996": 1
    }
},
{
    "nombre": "SGC",
    "lat": 4.6368,
    "lng": -74.0675,
    "ciudad": "Bogota",
    "categoria": "Ciencias Naturales",
    "publicaciones": {
        "2022": 177,
        "2019": 110,
        "2018": 97,
        "2020": 87,
        "2021": 85,
        "2015": 75,
        "2023": 62,
        "2017": 56,
        "2016": 45,
        "2014": 18,
        "2013": 17,
        "2011": 12,
        "2007": 6,
        "1970": 5,
        "1961": 4,
        "2010": 4,
        "1958": 3,
        "2008": 3,
        "2009": 3,
        "2012": 3,
        "2024": 3,
        "1957": 2,
        "1962": 2,
        "1967": 2,
        "1979": 2,
        "1985": 2,
        "1993": 2,
        "1995": 2,
        "1999": 2,
        "1897": 1,
        "1943": 1,
        "1959": 1,
        "1963": 1,
        "1965": 1,
        "1968": 1,
        "1969": 1,
        "1971": 1,
        "1972": 1,
        "1973": 1,
        "1975": 1,
        "1983": 1,
        "1987": 1,
        "1989": 1,
        "1990": 1,
        "1992": 1,
        "1997": 1,
        "1998": 1,
        "2000": 1,
        "2001": 1,
        "2006": 1
    }
},
{
    "nombre": "INVEMAR",
    "lat": 11.2275,
    "lng": -74.1822,
    "ciudad": "Santa Marta",
    "categoria": "Ciencias Naturales",
    "publicaciones": {
        "2016": 210,
        "2021": 59,
        "2023": 48,
        "2019": 33,
        "2022": 31,
        "2014": 24,
        "2020": 24,
        "2018": 18,
        "2010": 16,
        "2017": 15,
        "2006": 14,
        "2012": 14,
        "2011": 13,
        "2015": 13,
        "2005": 12,
        "2013": 12,
        "2001": 11,
        "2003": 10,
        "2007": 10,
        "1999": 9,
        "1998": 8,
        "2008": 8,
        "2009": 8,
        "2024": 8,
        "2004": 4,
        "1984": 3,
        "1991": 3,
        "1997": 3,
        "2002": 3,
        "1983": 2,
        "1988": 2,
        "1990": 2,
        "1992": 2,
        "1995": 2,
        "1996": 2,
        "2000": 2,
        "1969": 1,
        "1970": 1,
        "1973": 1,
        "1974": 1,
        "1976": 1,
        "1980": 1,
        "1985": 1,
        "1986": 1,
        "1993": 1,
        "1994": 1
    }
},
{
    "nombre": "INC",
    "lat": 4.6386,
    "lng": -74.0833,
    "ciudad": "Bogotá",
    "categoria": "Ciencias medicas y de la salud",
    "publicaciones": {
        "2022": 196,
        "2023": 187,
        "2021": 186,
        "2020": 155,
        "2019": 132,
        "2017": 121,
        "2018": 118,
        "2015": 107,
        "2016": 99,
        "2010": 90,
        "2014": 87,
        "2013": 85,
        "2012": 75,
        "2011": 67,
        "2009": 64,
        "2005": 51,
        "2008": 43,
        "2004": 40,
        "2024": 34,
        "2006": 31,
        "2007": 31,
        "2003": 23,
        "2002": 20,
        "1993": 17,
        "1996": 16,
        "1998": 12,
        "1997": 11,
        "1985": 9,
        "1991": 9,
        "1999": 8,
        "2001": 8,
        "1990": 7,
        "1989": 6,
        "1992": 5,
        "2000": 5,
        "1981": 4,
        "1995": 4,
        "1970": 3,
        "1972": 3,
        "1984": 3,
        "1994": 3,
        "1983": 2,
        "1986": 2,
        "1987": 2,
        "1964": 1,
        "1968": 1,
        "1969": 1,
        "1973": 1,
        "1977": 1,
        "1978": 1,
        "1979": 1,
        "1980": 1,
        "1988": 1
    }
},
{
    "nombre": "CDFLA",
    "lat": 4.6481,
    "lng": -74.0613,
    "ciudad": "Bogotá",
    "categoria": "Ciencias medicas y de la salud",
    "publicaciones": {
        "2020": 30,
        "2017": 26,
        "2021": 26,
        "2019": 24,
        "2023": 24,
        "2014": 21,
        "2016": 21,
        "2013": 19,
        "2018": 17,
        "2012": 16,
        "2015": 16,
        "2022": 16,
        "2024": 9,
        "2007": 7,
        "2006": 6,
        "2011": 5,
        "1996": 4,
        "2010": 3,
        "1981": 2,
        "1998": 2,
        "2002": 2,
        "2004": 2,
        "2008": 2,
        "2009": 2,
        "1941": 1,
        "1942": 1,
        "1944": 1,
        "1947": 1,
        "1965": 1,
        "1973": 1,
        "1975": 1,
        "1977": 1
    }
}
        ];

        let map = L.map('map').setView([4.710989, -74.072092], 6);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        let markers = [];

        centros.forEach((centro, index) => {
            const marker = L.marker([centro.lat, centro.lng]).addTo(map).bindPopup(`<div>
                <h3>${centro.nombre}</h3>
                <p><strong>Categoría:</strong> ${centro.categoria}</p>
                <p><strong>Ciudad:</strong> ${centro.ciudad}</p>
                <div class="chart-container">
                    <canvas id="chart_${index}"></canvas>
                </div>
            </div>`);

            marker.on('popupopen', function() {
                const ctx = document.getElementById(`chart_${index}`).getContext('2d');
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: Object.keys(centro.publicaciones),
                        datasets: [{
                            label: 'Publicaciones',
                            data: Object.values(centro.publicaciones),
                            borderColor: 'rgba(75, 192, 192, 1)',
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderWidth: 1,
                            fill: false
                        }]
                    },
                    options: {
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Año'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Número de Publicaciones'
                                },
                                beginAtZero: true
                            }
                        }
                    }
                });
            });

            markers.push({ marker, categoria: centro.categoria, ciudad: centro.ciudad });
        });

        function filterMarkers(category, city) {
            markers.forEach(({ marker, categoria, ciudad }) => {
                if ((category === 'All' || categoria === category) && (city === 'All' || ciudad === city)) {
                    marker.addTo(map);
                } else {
                    map.removeLayer(marker);
                }
            });
        }

        document.getElementById('categorySelector').addEventListener('change', function() {
            const category = this.value;
            const city = document.getElementById('citySelector').value;
            filterMarkers(category, city);
        });

        document.getElementById('citySelector').addEventListener('change', function() {
            const city = this.value;
            const category = document.getElementById('categorySelector').value;
            filterMarkers(category, city);
        });
    </script>
</body>
</html>
